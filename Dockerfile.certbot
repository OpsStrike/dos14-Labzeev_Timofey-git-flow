FROM ubuntu:18.04

RUN apt-get update && apt-get install -y git

RUN useradd -d /home/bank -U -m -u 3333 bank && mkdir /home/bank/git
                    
COPY --chown=bank:bank . .

WORKDIR /home/bank/git

RUN git clone https://github.com/certbot/certbot && chmod a+x ./certbot-auto
 
USER bank

RUN chmod +x /home/bank/git/setup_certificates.sh

EXPOSE 80 443

ENTRYPOINT ["/home/bank/git/setup_certificates.sh"]
